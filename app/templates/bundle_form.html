{% extends "layout.html" %}
{% block content %}
<h2>New Action Bundle — {{ active_dataset.label if active_dataset else 'Dataset' }}</h2>
<form action="/bundle" method="post" class="bundle-form">
    <input type="hidden" name="dataset" value="{{ active_dataset_id }}">
    <label>Part
        <input type="text" name="part" required>
    </label>
    <label>Bundle Name
        <input type="text" name="bundle_name" required>
    </label>
    <label>Keywords
        <input type="text" name="keywords" placeholder="Comma separated">
    </label>
    <label>Command
        <textarea name="command_text" rows="6" placeholder="한 줄에 하나씩 명령어를 입력하세요." id="commandInput"></textarea>
    </label>
    <div class="command-preview">
        <h3>Command Preview</h3>
        <ol id="previewList"></ol>
    </div>
    <p class="hint">Description은 명령어별 메모 섹션에서 입력할 수 있습니다.</p>
    <button type="submit">Save Bundle</button>
</form>

<script>
const textarea = document.getElementById("commandInput");
const preview = document.getElementById("previewList");
const updatePreview = () => {
    const commands = textarea.value.split(/\r?\n/).map(line => line.trim()).filter(Boolean);
    preview.innerHTML = "";
    commands.forEach(cmd => {
        const li = document.createElement("li");
        li.textContent = cmd;
        preview.appendChild(li);
    });
};
textarea.addEventListener("input", updatePreview);
</script>
{% endblock %}

